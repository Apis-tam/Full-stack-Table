"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[712],{1631:(e,r,t)=>{t.d(r,{$:()=>a});let a={url:t(9509).env.NEXT_PUBLIC_API_URL||""}},2712:(e,r,t)=>{t.r(r),t.d(r,{default:()=>L});var a=t(5155),l=t(2115);let n=(0,l.memo)(e=>{let{onChange:r,value:t,className:l,dataIndex:n,required:s,...o}=e;return(0,a.jsx)("input",{...o,required:s,value:t,onChange:r,"data-index":n,className:"p-1 flex justify-center align-middle rounded border border-transparent  hover:border-amber-300 focus:border-amber-600	".concat(l," ").concat(s?"border-b-red-600":""," ")})});n.displayName="Input";let s=["createdAt","updatedAt"],o=(0,l.memo)(e=>{let{item:r,rowIndex:t,cellIndex:o,isEditble:c,column:d,onChange:i,rowId:u}=e,m=(0,l.useCallback)(e=>{i&&i(u,d,e.target.value)},[d,i,u]);if(c){let e="string"==typeof r?r:null==r?void 0:r.toString();return(0,a.jsx)(n,{name:d,id:d,defaultValue:e,onChange:m,"data-index":"row-".concat(t,"-cell-").concat(o),className:"p-1 flex justify-center align-middle rounded border border-transparent  hover:border-amber-300 focus:border-amber-600 ".concat("logText"===d?"col-span-2":""," ").concat(e?"":"border-b-pink-500")},"".concat(r,"-").concat(d,"-").concat(u))}return(0,a.jsx)("div",{"data-index":"row-".concat(t,"-cell-").concat(o),className:"p-1 flex  align-middle",children:s.includes(d)?new Date(r).toLocaleDateString():r},"".concat(r,"-").concat(d,"-").concat(u))});o.displayName="Cell";let c=e=>{let{size:r="md",color:t="blue"}=e;return(0,a.jsx)("div",{className:"flex justify-center items-center w-[100%] h-[100%]",children:(0,a.jsx)("div",{className:"animate-spin rounded-full border-4 ".concat({sm:"w-6 h-6",md:"w-12 h-12",lg:"w-16 h-16"}[r]," ").concat({blue:"border-blue-500 border-t-transparent",gray:"border-gray-500 border-t-transparent",red:"border-red-500 border-t-transparent"}[t]," rounded-t-5 rounded-b-5")})})},d=(0,l.memo)(e=>{let{columns:r,withEditColumns:t,className:l}=e;return(0,a.jsxs)("div",{className:"grid  justify-items-center align-items-center  bg-blue-600 gap-1 ".concat(l," "),children:[r.map(e=>(0,a.jsx)("div",{className:"p-1 ".concat("logText"===e?"col-span-2":""),children:e},e)),t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"p-1  bg-blue-600"}),(0,a.jsx)("div",{className:"p-1  bg-blue-600"})]}):null]})});d.displayName="TableHeader";let i=(0,l.memo)(e=>{let{data:r,cell:t,actionSlots:l}=e;if(!r||!r[0])return null;let n=Object.keys(r[0]).filter(e=>"id"!==e),s=l?"grid-cols-7":"grid-cols-5";return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex flex-col gap-3  w-[100%] p-1 rounded shadow md:hidden ",children:r.map((e,r)=>(0,a.jsxs)("div",{"data-row":r,className:"flex flex-col w-[100%] gap-2 border-2 border-gray-500  p-1 rounnded",children:[n.map((l,n)=>(0,a.jsxs)("div",{className:"border-b-2 border-b-gray-700 pb-1",children:[(0,a.jsxs)("p",{className:"p-1 align-middle",children:[l,":"]}),t({item:e[l],column:l,rowIndex:r,cellIndex:n,rowId:e.id})]},l+"-field")),l?(0,a.jsx)("div",{"data-index":"row-".concat(r,"-cell-delete"),className:"p-1 flex align-middle col-span-2",children:l(e)}):null]},e.id+"row"))}),(0,a.jsxs)("div",{className:"hidden md:block  border-2 w-[100%] p-1 rounded shadow ",children:[(0,a.jsx)(d,{className:s,columns:n,withEditColumns:!!l}),r.map((e,r)=>(0,a.jsxs)("div",{"data-row":r,className:"grid ".concat(s," gap-1"),children:[n.map((a,l)=>t({item:e[a],column:a,rowIndex:r,cellIndex:l,rowId:e.id})),l?(0,a.jsx)("div",{"data-index":"row-".concat(r,"-cell-delete"),className:"p-1 flex justify-center align-middle col-span-2",children:l(e)}):null]},r))]})]})});i.displayName="Table";var u=t(6715),m=t(2960),h=t(5041),x=t(1631);let b=e=>{throw Error("Update request Error: ".concat(e.status,", ").concat(e.statusText))},g=window?localStorage.getItem("accessToken"):"",p={"Content-Type":"application/json",Authorization:"Bearer ".concat(g),credentials:"include"},y=async(e,r)=>{let t=new URLSearchParams(e).toString();try{let e=await fetch("".concat(x.$.url,"/table?").concat(t),{headers:{...p},signal:r});return e.ok||b(e),e.json()}catch(e){throw e}},f=async e=>{try{let r=await fetch("".concat(x.$.url,"/table"),{method:"POST",headers:{...p},body:JSON.stringify(e)});return r.ok||b(r),r.json()}catch(e){throw e}},j=async e=>{try{let r=await fetch("".concat(x.$.url,"/table/").concat(e.id),{method:"PUT",headers:{...p},body:JSON.stringify(e)});return r.ok||b(r),r.json()}catch(e){throw e}},w=async e=>{try{let r=await fetch("".concat(x.$.url,"/table/").concat(e),{method:"DELETE"});r.ok||b(r)}catch(e){throw e}};var v=t(5799);let N=(0,l.memo)(e=>{let{onClick:r,className:t,children:l,disabled:n,...s}=e;return(0,a.jsx)("button",{...s,disabled:n,onClick:r,className:"p-1  rounded border-0 hover:bg-blue-300 focus:border-b-fuchsia-500  ".concat(t," ").concat(n?"bg-gray-200 text-black":""),children:l})});N.displayName="Button";let C=e=>{let{currentPage:r,totalPages:t,onPageChange:l}=e,n=e=>{"number"==typeof e&&l(e)};return(0,a.jsxs)("nav",{className:"flex items-center justify-center space-x-2 my-4",children:[(0,a.jsx)("button",{onClick:()=>n(r-1),disabled:1===r,className:"px-3 py-1 rounded-md bg-gray-100 text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-200",children:"Previous"}),(()=>{let e=[],a=Math.max(1,r-Math.floor(2.5)),l=Math.min(t,a+5-1);l-a+1<5&&(a=Math.max(1,l-5+1)),a>1&&(e.push(1),a>2&&e.push("..."));for(let r=a;r<=l;r++)e.push(r);return l<t&&(l<t-1&&e.push("..."),e.push(t)),e})().map((e,t)=>(0,a.jsx)("button",{onClick:()=>n(e),disabled:"..."===e||e===r,className:"px-3 py-1 rounded-md ".concat(e===r?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"," ").concat("..."===e?"cursor-default":""),children:e},t)),(0,a.jsx)("button",{onClick:()=>n(r+1),disabled:r===t,className:"px-3 py-1 rounded-md bg-gray-100 text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-200",children:"Next"})]})};var k=t(7650);let E=e=>{let{isOpen:r,onClose:t,title:n,children:s,onConfirm:o,confirmButtonText:c="Yes"}=e,d=(0,l.useRef)(null);if(!r)return null;if(document.getElementById("portal"))d.current=document.getElementById("portal");else{let e=document.createElement("div");document.body.append(e),e.id="portal",d.current=e}return d.current&&(0,k.createPortal)((0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-white bg-opacity-50",children:(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-xl max-w-lg w-full m-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[n&&(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-200",children:n}),(0,a.jsx)(N,{"aria-label":"Close modal",className:"text-gray-500 hover:text-gray-700 focus:outline-none",onClick:t,children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s?(0,a.jsx)("div",{className:"p-4",children:s}):null,(0,a.jsxs)("div",{className:"flex p-4 border-t gap-2",children:[(0,a.jsx)(N,{onClick:o,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition",children:c}),(0,a.jsx)(N,{onClick:t,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition",children:"Close"})]})]})}),d.current)},S=e=>{let{onClose:r,isOpen:t,onConfirm:s,title:o="Create new row"}=e,[c,d]=(0,l.useState)({owner:!1,logText:!1}),i=(0,l.useRef)(null),u=(0,l.useRef)(null),m=(0,l.useCallback)(()=>{var e,r,t,a;if((null==(e=i.current)?void 0:e.value)&&(null==(r=u.current)?void 0:r.value)){s({owner:i.current.value,logText:u.current.value}),d({owner:!1,logText:!1});return}d({owner:!(null==(t=i.current)?void 0:t.value),logText:!(null==(a=u.current)?void 0:a.value)})},[s]);return(0,a.jsx)(E,{isOpen:t,title:o,onClose:r,onConfirm:m,children:(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("label",{className:" colorcaret-black",children:["Owner:",(0,a.jsx)(n,{ref:i,required:c.owner,className:"caret-black bg-gray-600"})]}),(0,a.jsxs)("label",{className:"caret-black",children:["Log Text:",(0,a.jsx)(n,{ref:u,required:c.logText,className:"caret-black bg-gray-600"})]})]})})},T=["logText","owner"],R=()=>{let{data:e,isLoading:r,update:t,create:n,deleteReq:s,currentPage:d,setPage:x,totalPages:b}=(()=>{let e=(0,u.jE)(),[r,t]=(0,l.useState)([]),[a,n]=(0,l.useState)(1),[s,o]=(0,l.useState)(0),c={page:a.toString()},{data:d,isLoading:i,error:x}=(0,m.I)({staleTime:3e5,queryKey:["data",c],queryFn:e=>{let{signal:r}=e;return y(c,r)}}),b=(0,h.n)({mutationFn:function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return f(...r)},onSuccess:()=>{e.invalidateQueries({queryKey:["data"]}),(0,v.oR)("Row Created",{type:"success"})},onError(e){(0,v.oR)("Error: "+e.message,{type:"error"})}});(0,l.useMemo)(()=>{d&&(t(d.data.result),o(Math.max(1,Math.ceil(d.data.total/d.data.pageSize))),n(Number(d.data.page)))},[d]);let g=(0,h.n)({mutationFn:function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return j(...r)},onSuccess:()=>{e.invalidateQueries({queryKey:["data"]}),(0,v.oR)("Row Updated",{type:"success"})},onError(e){(0,v.oR)("Error: "+e.message,{type:"error"})}}),p=(0,h.n)({mutationFn:function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return w(...r)},onSuccess:()=>{e.invalidateQueries({queryKey:["data"]}),(0,v.oR)("Row Deleted",{type:"success"})},onError(e){(0,v.oR)("Error: "+e.message,{type:"error"})}});return{currentPage:a,setPage:n,totalPages:s,data:r,isLoading:i||g.isPending||b.isPending||p.isPending,isError:x||b.error||p.error||g.error,update:g.mutate,create:b.mutate,deleteReq:p.mutate}})(),[g,p]=(0,l.useReducer)(e=>!e,!1),[k,R]=(0,l.useState)(null),[P,I]=(0,l.useState)(""),O=(0,l.useCallback)((r,t,a)=>{if(k&&k.id===r)return void R(e=>e?{...e,[t]:a,id:r}:e);R({...e.find(e=>e.id===r),[t]:a})},[e,k]),L=(0,l.useCallback)(e=>{if(k&&k.id===e){t(k),R(null);return}(0,v.oR)("Nothing save at this row",{type:"info",delay:2e3})},[k,t]),q=(0,l.useCallback)(e=>{n(e),p()},[n]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-end  items-center p-2 mb-3 w-[100%]",children:[(0,a.jsx)("p",{className:"h-4 ml-2 mr-2",children:"Create new Row :"}),(0,a.jsx)(N,{className:" bg-emerald-600",onClick:p,children:"Create"})]}),r?(0,a.jsx)(c,{}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i,{data:e,actionSlots:e=>(0,a.jsxs)("div",{className:"w-[100%] flex justify-around",children:[(0,a.jsx)(N,{className:"bg-orange-500 rounded-t-5 rounded-b-5",onClick:()=>I(e.id),children:"Delete"}),(0,a.jsx)(N,{disabled:e.id!==(null==k?void 0:k.id),onClick:()=>L(e.id),className:"bg-emerald-400 rounded-t-5 rounded-b-5",children:"Save"})]}),cell:e=>{let{item:r,column:t,rowIndex:l,cellIndex:n,rowId:s}=e;return(0,a.jsx)(o,{column:t,item:r,rowIndex:l,cellIndex:n,isEditble:T.includes(t),rowId:s,onChange:O},"".concat(r,"-").concat(t))}}),(0,a.jsx)(C,{currentPage:d,totalPages:b,onPageChange:x}),(0,a.jsx)(E,{onConfirm:()=>{s(P),I("")},title:"Are you sure, remove this row?",isOpen:!!P,onClose:()=>I("")}),(0,a.jsx)(S,{onConfirm:q,title:"Are you sure, remove this row?",isOpen:g,onClose:p})]})]})};var P=t(7017),I=t(192);class O extends l.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,r){console.error("ErrorBoundary caught an error:",e,r)}render(){if(this.state.hasError){var e;return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:(0,a.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:(null==(e=this.state.error)?void 0:e.message)||"An unexpected error occurred"}),(0,a.jsx)("button",{className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition",onClick:()=>window.location.reload(),children:"Reload Page"})]})})}return this.props.children}constructor(e){super(e),this.state={hasError:!1,error:null}}}let L=()=>{let e=new P.E;return(0,a.jsx)(O,{children:(0,a.jsxs)(u.Ht,{client:e,children:[(0,a.jsx)("main",{className:"flex flex-col w-[100%] gap-[32px] row-start-2 items-center sm:items-start",children:(0,a.jsx)(R,{})}),(0,a.jsx)("footer",{className:"row-start-3 flex gap-[24px] flex-wrap items-center justify-center",children:(0,a.jsx)(v.N9,{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!1,rtl:!1,pauseOnFocusLoss:!0,pauseOnHover:!0,theme:"light",transition:v.K9})}),(0,a.jsx)(I.E,{initialIsOpen:!1})]})})}}}]);